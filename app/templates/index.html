{% extends "base.html" %}

{% block content %}
    <div class="bg-success px-3 py-3" style="color: white;">
        <h1 class="mb-3">学習管理Web</h1>
        ※まだ殆ど作成していません。(2025/9/22)<br>
        {% if username %}
            ※{{ username }}でログイン中です。
            <form method="GET" action="{{ url_for('main.input_record') }}" style="display: inline-block; margin-right: 10px;">
                <button type="submit" class="btn btn-info", style="color: white;">新規入力</button>
            </form>
            <form method="POST" action="{{ url_for('main.logout') }}" style="display: inline-block;">
                <button type="submit" class="btn btn-info", style="color: white;">ログアウト</button>
            </form>
        {% endif %}
    </div>

    <div class="mb-3 table-responsive border p-2" style="max-height: 400px; overflow-y: auto;">
        <table class="table table-hover text-start" style="width: auto;">
            <thead>
                <tr>
                    <th>カテゴリ</th>
                    <th>開始日時</th>
                    <th>終了日時</th>
                    <th>内容</th>
                    <th>備考</th>
                    <th>入力者</th>
                    <th>編集</th>
                </tr>
            </thead>
            <tbody class="table-group-divider">
                {% for rec in records: %}
                    <tr>
                        <td>{{ rec.categories.category_name }}</td>
                        <td>{{ rec.study_date_start }}</td>
                        <td>{{ rec.study_date_end }}</td>
                        <td style="max-width: 700px; white-space: pre-wrap; word-break: break-word;">{{ rec.confirm }}</td>
                        <td>{{ rec.remark }}</td>
                        <td>{{ rec.users.name }}</td>
                        {% if username and user_id == rec.user_id %}
                        <td><a href="{{ url_for('main.input_record', id=rec.id) }}">編集</a></td>
                        {% else %}
                        <td></td>
                        {% endif %}
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <h4>入力者向けログイン</h4>
    <form method="POST" action="{{ url_for('main.login') }}">
        {{ login.hidden_tag() }}
        <div class="row g-3 align-items-end" style="max-width: 700px;">
        <div class="col-auto">
            {{ login.username.label(class="form-label") }}
            {{ login.username(class="form-control") }}
        </div>
        <div class="col-auto">
            {{ login.password.label(class="form-label") }}
            {{ login.password(class="form-control") }}
        </div>
        <div class="col-auto">
            {{ login.submit(class="btn btn-info", style="color: white;") }}
        </div>
        </div>
    </form>
{% endblock %}